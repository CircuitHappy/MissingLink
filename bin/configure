#!/bin/bash
if [[ "$OSTYPE" == "darwin"* ]]; then
  vagrant ssh -c "cd missinglink && bin/configure"
  exit $? 
fi

MISSINGLINK_DIR=`pwd`
BUILDROOT_DIR="${BUILDROOT_DIR:-${MISSINGLINK_DIR}/..}"

cd "${BUILDROOT_DIR}/CHIP-buildroot"
make missinglink_defconfig
make

cd "${MISSINGLINK_DIR}"
rm -r build/*
cd build
cmake -D_BUILDROOT_DIR="${BUILDROOT_DIR}" ..
